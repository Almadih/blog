<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Tags - Almadih&#x27;s Blog</title><meta name="gridsome:hash" content="05f99e1c44f1905ac2c49c0457bdfce37207dec2"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="description" name="description" content="Almadih&#x27;s Personal Blog"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/blog/assets/static/favicon.ce0531f.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/blog/assets/static/favicon.ac8d93a.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/blog/assets/static/favicon.b9532cc.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/blog/assets/static/favicon.f22e9f3.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/blog/assets/static/favicon.62d22cb.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/blog/assets/static/favicon.1539b60.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/blog/assets/static/favicon.dc0cdc5.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/blog/assets/static/favicon.7b22250.9bb7ffafafc09ac851d81afb65b8ef59.png"><link rel="preload" href="/blog/assets/css/0.styles.ab6577af.css" as="style"><link rel="preload" href="/blog/assets/js/app.2456851f.js" as="script"><link rel="preload" href="/blog/assets/js/page--src--templates--tag-vue.5f26cf99.js" as="script"><link rel="prefetch" href="/blog/assets/js/page--node-modules--gridsome--app--pages--404-vue.101df3a8.js"><link rel="prefetch" href="/blog/assets/js/page--src--pages--index-vue.90da632a.js"><link rel="prefetch" href="/blog/assets/js/page--src--templates--post-vue.695a322f.js"><link rel="stylesheet" href="/blog/assets/css/0.styles.ab6577af.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <script>
      // Add dark / light detection that runs before Vue.js load. Borrowed from overreacted.io
      (function() {
        window.__onThemeChange = function() {};
        function setTheme(newTheme) {
          window.__theme = newTheme;
          preferredTheme = newTheme;
          document.body.setAttribute('data-theme', newTheme);
          window.__onThemeChange(newTheme);
        }

        var preferredTheme;
        try {
          preferredTheme = localStorage.getItem('theme');
        } catch (err) { }

        window.__setPreferredTheme = function(newTheme) {
          setTheme(newTheme);
          try {
            localStorage.setItem('theme', newTheme);
          } catch (err) {}
        }

        var darkQuery = window.matchMedia('(prefers-color-scheme: dark)');
        darkQuery.addListener(function(e) {
          window.__setPreferredTheme(e.matches ? 'dark' : 'light')
        });

        setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'));
      })();
    </script>

    <div id="app" data-server-rendered="true"><header class="header"><div class="header__left"><a href="/blog/" class="logo active"><span class="logo__text"> ← Almadih's Blog </span></a></div><div class="header__right"><button role="button" aria-label="Toggle dark/light" class="toggle-theme"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></button></div></header><main class="main"><h1 class="tag-title text-center space-bottom"># async</h1><div class="posts"><div class="post-card content-box"><div class="post-card__header"><img alt="Cover image" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 860 328' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-b8150a768b39512b039f381255233a66'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='10'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-b8150a768b39512b039f381255233a66)' width='860' height='328' xlink:href='data:image/webp%3bbase64%2cUklGRtAAAABXRUJQVlA4IMQAAABwBgCdASpAABgAPm0ylUekIqIhpAtogA2JQBgiuB8ANAAmf4eQqELO%2bIwWJ7pN2HvtNexojDH2yTkFaAAA/HsU9d8yOT%2b3/k%2byvusvB3oq0PH6yzqrjJwJmV2q3o7kQeJbVgNOz9fyLJYCFaVD9GiLVB4gc1NmSVxL3EaFzlBT5FbYm53r3JvZNrzygpPA5pQRsTps8b7XRsxW3/LZ/iUOW%2bCrv1gPnb/pyCKXCkBhRKWh%2bWmlZ4E703W8Yh5iaYgVwfAA' /%3e%3c/svg%3e" width="860" data-src="/blog/assets/static/asyncio.07cc2b7.c2a4792af2020212327b44e52a6fe3f7.webp" data-srcset="/blog/assets/static/asyncio.a67b0b2.c2a4792af2020212327b44e52a6fe3f7.webp 480w, /blog/assets/static/asyncio.07cc2b7.c2a4792af2020212327b44e52a6fe3f7.webp 860w" data-sizes="(max-width: 860px) 100vw, 860px" class="post-card__image g-image g-image--lazy g-image--loading"><noscript><img src="/blog/assets/static/asyncio.07cc2b7.c2a4792af2020212327b44e52a6fe3f7.webp" class="post-card__image g-image g-image--loaded" width="860" alt="Cover image"></noscript></div><div class="post-card__content"><h2 class="post-card__title">Convert sync code to async in python</h2><p class="post-card__description">Asynchronous programming has become increasingly popular in recent years, as it allows you to write code that can perform multiple tasks concurrently.</p><div class="post-meta post-card__meta">
   Posted 12. December 2023.
   <strong>2 min read.</strong></div><div class="post-tags post-card__tags"></div><a href="/blog/convert-sync-code-to-async-in-python/" class="post-card__link">Link</a></div></div></div></main><footer class="footer"><span class="footer__copyright">Copyright © 2023.
    </span><span class="footer__links">Powered by <a href="//gridsome.org"> Gridsome </a></span></footer></div>
    <script>window.__INITIAL_STATE__={"data":{"tag":{"title":"async","belongsTo":{"edges":[{"node":{"title":"Convert sync code to async in python","path":"\u002Fconvert-sync-code-to-async-in-python\u002F","date":"12. December 2023","timeToRead":2,"description":"Asynchronous programming has become increasingly popular in recent years, as it allows you to write code that can perform multiple tasks concurrently.","coverImage":{"type":"image","mimeType":"image\u002Fwebp","src":"\u002Fblog\u002Fassets\u002Fstatic\u002Fasyncio.07cc2b7.c2a4792af2020212327b44e52a6fe3f7.webp","size":{"width":860,"height":328},"sizes":"(max-width: 860px) 100vw, 860px","srcset":["\u002Fblog\u002Fassets\u002Fstatic\u002Fasyncio.a67b0b2.c2a4792af2020212327b44e52a6fe3f7.webp 480w","\u002Fblog\u002Fassets\u002Fstatic\u002Fasyncio.07cc2b7.c2a4792af2020212327b44e52a6fe3f7.webp 860w"],"dataUri":"data:image\u002Fsvg+xml,%3csvg fill='none' viewBox='0 0 860 328' xmlns='http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg' xmlns:xlink='http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-b8150a768b39512b039f381255233a66'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='10'\u002F%3e%3c\u002Ffilter%3e%3c\u002Fdefs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-b8150a768b39512b039f381255233a66)' width='860' height='328' xlink:href='data:image\u002Fwebp%3bbase64%2cUklGRtAAAABXRUJQVlA4IMQAAABwBgCdASpAABgAPm0ylUekIqIhpAtogA2JQBgiuB8ANAAmf4eQqELO%2bIwWJ7pN2HvtNexojDH2yTkFaAAA\u002FHsU9d8yOT%2b3\u002Fk%2byvusvB3oq0PH6yzqrjJwJmV2q3o7kQeJbVgNOz9fyLJYCFaVD9GiLVB4gc1NmSVxL3EaFzlBT5FbYm53r3JvZNrzygpPA5pQRsTps8b7XRsxW3\u002FLZ\u002FiUOW%2bCrv1gPnb\u002FpyCKXCkBhRKWh%2bWmlZ4E703W8Yh5iaYgVwfAA' \u002F%3e%3c\u002Fsvg%3e"},"content":"\u003Ch2 id=\"intorduction\"\u003E\u003Ca href=\"#intorduction\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EIntorduction\u003C\u002Fh2\u003E\n\u003Cp\u003EAsynchronous programming has become increasingly popular in recent years, as it allows you to write code that can perform multiple tasks concurrently. This can be especially useful when working with tasks that involve waiting for a response, such as making HTTP requests or accessing a database.\u003C\u002Fp\u003E\n\u003Cp\u003EIn Python, you can write asynchronous code using the asyncio module and the async\u002Fawait syntax. In this post, we'll go over how to convert sync code to async in Python and some best practices to follow when writing async code.\u003C\u002Fp\u003E\n\u003Ch3 id=\"identify-blocking-code\"\u003E\u003Ca href=\"#identify-blocking-code\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EIdentify blocking code\u003C\u002Fh3\u003E\n\u003Cp\u003EThe first step in converting sync code to async is to identify the code that is blocking the main thread and causing it to wait for a response. This can include things like making HTTP requests, reading and writing to databases, or accessing the file system.\u003C\u002Fp\u003E\n\u003Cp\u003EFor example, consider the following sync code that makes an HTTP request using the requests library:\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"python\"\u003E\u003Cpre class=\"language-python\"\u003E\u003Ccode class=\"language-python\"\u003E\u003Cspan class=\"token keyword\"\u003Eimport\u003C\u002Fspan\u003E requests\n\n\u003Cspan class=\"token keyword\"\u003Edef\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Eget_data\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n    response \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E requests\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eget\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"https:\u002F\u002Fexample.com\u002Fapi\u002Fendpoint\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    data \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E response\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Ejson\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E data\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EThis code will block the main thread until the HTTP request has completed and the response has been received. To convert this code to async, we'll need to use an async library like aiohttp instead of the sync requests library.\nbut if there is no alternatives, (and this the reason why i am writing this post), you can use asyncio to convert for example a third party library to be async lets say we want to run the above code multiple times, with it current form it surly will wait until the first run end and move to the next, to overcome this we can make the following changes:\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"python\"\u003E\u003Cpre class=\"language-python\"\u003E\u003Ccode class=\"language-python\"\u003E\u003Cspan class=\"token keyword\"\u003Eimport\u003C\u002Fspan\u003E requests\n\u003Cspan class=\"token keyword\"\u003Eimport\u003C\u002Fspan\u003E asyncio\n\u003Cspan class=\"token keyword\"\u003Edef\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Eget_data\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n    response \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E requests\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eget\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"https:\u002F\u002Fexample.com\u002Fapi\u002Fendpoint\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    data \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E response\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Ejson\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E data\n\n\u003Cspan class=\"token keyword\"\u003Easync\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Edef\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Emain\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token comment\"\u003E#get the current running event loop\u003C\u002Fspan\u003E\n    loop \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E asyncio\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eget_event_loop\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token comment\"\u003E#list to store pending coroutines \u003C\u002Fspan\u003E\n    results \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token keyword\"\u003Efor\u003C\u002Fspan\u003E i \u003Cspan class=\"token keyword\"\u003Ein\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Erange\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E10\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token comment\"\u003E#pass the target function to the executer, and its params if available \u003C\u002Fspan\u003E\n        results\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eappend\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eloop\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Erun_in_executor\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token boolean\"\u003ENone\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003Eget_data\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token comment\"\u003E#here is the blocking part where we wait for all pending results\u003C\u002Fspan\u003E\n    results \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E asyncio\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Egather\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003Eresults\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E __name__ \u003Cspan class=\"token operator\"\u003E==\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"__main__\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n    asyncio\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Erun\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Emain\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003E\u003Ccode class=\"language-inline-text\"\u003Eloop.run_in_executor\u003C\u002Fcode\u003E is a method provided by the asyncio module in Python that allows you to run a function concurrently in a separate thread or process. It's commonly used to run sync code concurrently with async code, as sync code can block the event loop and prevent other async tasks from running.\u003C\u002Fp\u003E\n\u003Ch3 id=\"conclusion\"\u003E\u003Ca href=\"#conclusion\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EConclusion\u003C\u002Fh3\u003E\n\u003Cp\u003EConverting sync code to async in Python can be a challenging task, but the benefits of async programming make it well worth the effort. By using the asyncio module and async libraries, and following best practices like avoiding sync code and thoroughly testing your code, you can write efficient, concurrent Python code that can scale to handle high levels of traffic and workload.\u003C\u002Fp\u003E\n"}}]}}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/blog/assets/js/app.2456851f.js" defer></script><script src="/blog/assets/js/page--src--templates--tag-vue.5f26cf99.js" defer></script>
  </body>
</html>